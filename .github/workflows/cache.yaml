name            :   cache job workflow
on              :
    workflow_dispatch :
        inputs  :
            use-cache :
                description : Whether to execute the cache step
                type        : boolean
                default     : true

            node-version :
                type : choice
                options : 
                - 18.x
                - 19.x
                - 20.x
                - 21.x
                default : 20.x

jobs :
    build :
        runs-on : ubuntu-latest
        steps   :
            - name : code checkout
              uses : actions/checkout@v4
            - name : Setup Node
              uses : actions/setup-node@v3
              with :
                node-version : ${{inputs.node-version}}
            - name : Download cache dependencies
              uses : actions/cache@v3
              id   : cache
              with :
                path : node_modules
                key: deps-node-module-${{hashFiles('package-lock.json')}}
            - name : Install dependencies
              if   : steps.cache.outputs.cache-hit != 'true'
              run  : npm install
            - name : Testing
              run  : npm run test
            - name : Building
              run  : npm run build
            - name : Deploying to nonprod
              run  : echo "Deploying to nonprod"